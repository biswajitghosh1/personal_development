{% extends "layout.html" %}
{% block content %}
  <h2>Summary for {{ month }}/{{ year }}</h2>

  <p>Total entries: {{ summary.total_entries }}</p>
  <p>Total words (approx): {{ summary.total_words }}</p>
  <p>Average words per entry: {{ summary.average_words_per_entry|round(1) }}</p>

  <h3>Top words</h3>
  {% if summary.top_words %}
    <ol>
      {% for word, count in summary.top_words %}
        <li>{{ word }} — {{ count }}</li>
      {% endfor %}
    </ol>
  {% else %}
    <p>No top words (no entries).</p>
  {% endif %}

  <h3>Entries</h3>
  {% if entries %}
    <ul>
      {% for e in entries %}
        <li>
          <strong>{{ e.entry_date }} - {{ e.title }}{% if e.important %} <span class="imp-badge">IMPORTANT</span>{% endif %}</strong>
          <div class="content-preview">{{ e.content[:400]|safe }}{% if e.content|length > 400 %}…{% endif %}</div>
          <div>
            {% if current_user.is_authenticated %}
              <a href="{{ url_for('edit_entry', entry_id=e.id) }}">Edit</a>
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No entries for this month.</p>
  {% endif %}

  <hr>
  <p>
    <a href="{{ url_for('export') }}?start={{ year }}-{{ "%02d"|format(month) }}-01&end={{ year }}-{{ "%02d"|format(month) }}-31&format=docx">Export DOCX</a> |
    <a href="{{ url_for('export') }}?start={{ year }}-{{ "%02d"|format(month) }}-01&end={{ year }}-{{ "%02d"|format(month) }}-31&format=csv">Export CSV</a> |
    <a href="{{ url_for('export') }}?start={{ year }}-{{ "%02d"|format(month) }}-01&end={{ year }}-{{ "%02d"|format(month) }}-31&format=json">Export JSON</a>
  </p>
{% endblock %}
